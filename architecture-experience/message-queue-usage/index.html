<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Message Queue Usage – Nextra</title><meta name="robots" content="index,follow"/><meta property="og:title" content="Message Queue Usage – Nextra"/><meta name="theme-color" content="#111" media="(prefers-color-scheme: dark)"/><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/><style>
        :root {
          --nextra-primary-hue: 212deg;
          --nextra-primary-saturation: 100%;
          --nextra-navbar-height: 4rem;
          --nextra-menu-height: 3.75rem;
          --nextra-banner-height: 2.5rem;
        }
        
        .dark {
          --nextra-primary-hue: 204deg;
          --nextra-primary-saturation: 100%;
        }
      </style><meta name="msapplication-TileColor" content="#fff"/><meta http-equiv="Content-Language" content="en"/><meta name="description" content="Nextra: the next docs builder"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@shuding_"/><meta property="og:title" content="Nextra: the next docs builder"/><meta property="og:description" content="Nextra: the next docs builder"/><meta name="apple-mobile-web-app-title" content="Nextra"/><meta name="next-head-count" content="15"/><link rel="preload" href="/docs-resume/_next/static/css/445c4173ffc2bf04.css" as="style" crossorigin=""/><link rel="stylesheet" href="/docs-resume/_next/static/css/445c4173ffc2bf04.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/docs-resume/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/docs-resume/_next/static/chunks/webpack-1ca17639c7234f73.js" defer="" crossorigin=""></script><script src="/docs-resume/_next/static/chunks/framework-0c7baedefba6b077.js" defer="" crossorigin=""></script><script src="/docs-resume/_next/static/chunks/main-b4c97bca79029e34.js" defer="" crossorigin=""></script><script src="/docs-resume/_next/static/chunks/pages/_app-c54702eb327175a3.js" defer="" crossorigin=""></script><script src="/docs-resume/_next/static/chunks/796-3c895c15a541f7ff.js" defer="" crossorigin=""></script><script src="/docs-resume/_next/static/chunks/pages/architecture-experience/message-queue-usage-1dc1d4288bbb1779.js" defer="" crossorigin=""></script><script src="/docs-resume/_next/static/GzRZMqokpyQjOyUBborm8/_buildManifest.js" defer="" crossorigin=""></script><script src="/docs-resume/_next/static/GzRZMqokpyQjOyUBborm8/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div dir="ltr"><script>document.documentElement.setAttribute('dir','ltr')</script><div class="nextra-nav-container nx-sticky nx-top-0 nx-z-20 nx-w-full nx-bg-transparent print:nx-hidden"><div class="nextra-nav-container-blur nx-pointer-events-none nx-absolute nx-z-[-1] nx-h-full nx-w-full nx-bg-white dark:nx-bg-dark nx-shadow-[0_2px_4px_rgba(0,0,0,.02),0_1px_0_rgba(0,0,0,.06)] dark:nx-shadow-[0_-1px_0_rgba(255,255,255,.1)_inset] contrast-more:nx-shadow-[0_0_0_1px_#000] contrast-more:dark:nx-shadow-[0_0_0_1px_#fff]"></div><nav class="nx-mx-auto nx-flex nx-h-[var(--nextra-navbar-height)] nx-max-w-[90rem] nx-items-center nx-justify-end nx-gap-2 nx-pl-[max(env(safe-area-inset-left),1.5rem)] nx-pr-[max(env(safe-area-inset-right),1.5rem)]"><a class="nx-flex nx-items-center hover:nx-opacity-75 ltr:nx-mr-auto rtl:nx-ml-auto" href="/docs-resume/"><span>Docs Resume</span></a><div class="nextra-search nx-relative md:nx-w-64 nx-hidden md:nx-inline-block mx-min-w-[200px]"><div class="nx-relative nx-flex nx-items-center nx-text-gray-900 contrast-more:nx-text-gray-800 dark:nx-text-gray-300 contrast-more:dark:nx-text-gray-300"><input spellcheck="false" class="nx-block nx-w-full nx-appearance-none nx-rounded-lg nx-px-3 nx-py-2 nx-transition-colors nx-text-base nx-leading-tight md:nx-text-sm nx-bg-black/[.05] dark:nx-bg-gray-50/10 focus:nx-bg-white dark:focus:nx-bg-dark placeholder:nx-text-gray-500 dark:placeholder:nx-text-gray-400 contrast-more:nx-border contrast-more:nx-border-current" type="search" placeholder="Search documentation…" value=""/></div></div><a href="https://github.com/chagchagchag/docs-resume" target="_blank" rel="noreferrer" class="nx-p-2 nx-text-current"><svg width="24" height="24" fill="currentColor" viewBox="3 3 18 18"><title>GitHub</title><path d="M12 3C7.0275 3 3 7.12937 3 12.2276C3 16.3109 5.57625 19.7597 9.15374 20.9824C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441C9.77249 20.3249 9.76125 19.5982 9.76125 18.8254C7.5 19.2522 6.915 18.2602 6.735 17.7412C6.63375 17.4759 6.19499 16.6569 5.8125 16.4378C5.4975 16.2647 5.0475 15.838 5.80124 15.8264C6.51 15.8149 7.01625 16.4954 7.18499 16.7723C7.99499 18.1679 9.28875 17.7758 9.80625 17.5335C9.885 16.9337 10.1212 16.53 10.38 16.2993C8.3775 16.0687 6.285 15.2728 6.285 11.7432C6.285 10.7397 6.63375 9.9092 7.20749 9.26326C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794C7.2975 6.81794 8.05125 6.57571 9.77249 7.76377C10.4925 7.55615 11.2575 7.45234 12.0225 7.45234C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377C15.9937 6.56418 16.7475 6.81794 16.7475 6.81794C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326C17.4113 9.9092 17.76 10.7281 17.76 11.7432C17.76 15.2843 15.6563 16.0687 13.6537 16.2993C13.98 16.5877 14.2613 17.1414 14.2613 18.0065C14.2613 19.2407 14.25 20.2326 14.25 20.5441C14.25 20.7863 14.4188 21.0746 14.8688 20.9824C16.6554 20.364 18.2079 19.1866 19.3078 17.6162C20.4077 16.0457 20.9995 14.1611 21 12.2276C21 7.12937 16.9725 3 12 3Z"></path></svg><span class="nx-sr-only">GitHub</span><span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a><button type="button" aria-label="Menu" class="nextra-hamburger -nx-mr-2 nx-rounded nx-p-2 active:nx-bg-gray-400/20 md:nx-hidden"><svg fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" class=""><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16"></path></g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h16"></path><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 18h16"></path></g></svg></button></nav></div><div class="nx-mx-auto nx-flex nx-max-w-[90rem]"><div class="motion-reduce:nx-transition-none [transition:background-color_1.5s_ease] nx-bg-transparent"></div><aside class="nextra-sidebar-container nx-flex nx-flex-col md:nx-top-16 md:nx-shrink-0 motion-reduce:nx-transform-none nx-transform-gpu nx-transition-all nx-ease-in-out print:nx-hidden md:nx-w-64 md:nx-sticky md:nx-self-start max-md:[transform:translate3d(0,-100%,0)]"><div class="nx-px-4 nx-pt-4 md:nx-hidden"><div class="nextra-search nx-relative md:nx-w-64"><div class="nx-relative nx-flex nx-items-center nx-text-gray-900 contrast-more:nx-text-gray-800 dark:nx-text-gray-300 contrast-more:dark:nx-text-gray-300"><input spellcheck="false" class="nx-block nx-w-full nx-appearance-none nx-rounded-lg nx-px-3 nx-py-2 nx-transition-colors nx-text-base nx-leading-tight md:nx-text-sm nx-bg-black/[.05] dark:nx-bg-gray-50/10 focus:nx-bg-white dark:focus:nx-bg-dark placeholder:nx-text-gray-500 dark:placeholder:nx-text-gray-400 contrast-more:nx-border contrast-more:nx-border-current" type="search" placeholder="Search documentation…" value=""/></div></div></div><div class="nx-overflow-y-auto nx-overflow-x-hidden nx-p-4 nx-grow md:nx-h-[calc(100vh-var(--nextra-navbar-height)-var(--nextra-menu-height))] nextra-scrollbar"><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100"><ul class="nx-flex nx-flex-col nx-gap-1 nextra-menu-desktop max-md:nx-hidden"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/">Introduction</a></li><li class="open"><a class="nx-items-center nx-justify-between nx-gap-2 nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/work-history/">재직 기록<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-h-[18px] nx-min-w-[18px] nx-rounded-sm nx-p-0.5 hover:nx-bg-gray-800/5 dark:hover:nx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="nx-origin-center nx-transition-transform rtl:-nx-rotate-180 ltr:nx-rotate-90 rtl:nx-rotate-[-270deg]"></path></svg></a><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100 ltr:nx-pr-0 rtl:nx-pl-0 nx-pt-1"><ul class="nx-flex nx-flex-col nx-gap-1 nx-relative before:nx-absolute before:nx-inset-y-1 before:nx-w-px before:nx-bg-gray-200 before:nx-content-[&quot;&quot;] dark:before:nx-bg-neutral-800 ltr:nx-pl-3 ltr:before:nx-left-0 rtl:nx-pr-3 rtl:before:nx-right-0 ltr:nx-ml-3 rtl:nx-mr-3"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/work-history/work-history/">재직기록</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/work-history/retire-reason/">퇴직사유</a></li></ul></div></div></li><li class="open"><a class="nx-items-center nx-justify-between nx-gap-2 nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/project-history/">프로젝트 수행 기록, 경력기술서<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-h-[18px] nx-min-w-[18px] nx-rounded-sm nx-p-0.5 hover:nx-bg-gray-800/5 dark:hover:nx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="nx-origin-center nx-transition-transform rtl:-nx-rotate-180 ltr:nx-rotate-90 rtl:nx-rotate-[-270deg]"></path></svg></a><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100 ltr:nx-pr-0 rtl:nx-pl-0 nx-pt-1"><ul class="nx-flex nx-flex-col nx-gap-1 nx-relative before:nx-absolute before:nx-inset-y-1 before:nx-w-px before:nx-bg-gray-200 before:nx-content-[&quot;&quot;] dark:before:nx-bg-neutral-800 ltr:nx-pl-3 ltr:before:nx-left-0 rtl:nx-pr-3 rtl:before:nx-right-0 ltr:nx-ml-3 rtl:nx-mr-3"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/project-history/project-history/">프로젝트 수행 기록</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/project-history/problem-solving-histories/">경력기술서</a></li></ul></div></div></li><li class="open"><a class="nx-items-center nx-justify-between nx-gap-2 nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/portfolio/">포트폴리오<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-h-[18px] nx-min-w-[18px] nx-rounded-sm nx-p-0.5 hover:nx-bg-gray-800/5 dark:hover:nx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="nx-origin-center nx-transition-transform rtl:-nx-rotate-180 ltr:nx-rotate-90 rtl:nx-rotate-[-270deg]"></path></svg></a><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100 ltr:nx-pr-0 rtl:nx-pl-0 nx-pt-1"><ul class="nx-flex nx-flex-col nx-gap-1 nx-relative before:nx-absolute before:nx-inset-y-1 before:nx-w-px before:nx-bg-gray-200 before:nx-content-[&quot;&quot;] dark:before:nx-bg-neutral-800 ltr:nx-pl-3 ltr:before:nx-left-0 rtl:nx-pr-3 rtl:before:nx-right-0 ltr:nx-ml-3 rtl:nx-mr-3"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/portfolio/portfolio/">portfolio</a></li></ul></div></div></li><li class="open"><a class="nx-items-center nx-justify-between nx-gap-2 nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/architecture-experience/">시스템 설계 경험<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-h-[18px] nx-min-w-[18px] nx-rounded-sm nx-p-0.5 hover:nx-bg-gray-800/5 dark:hover:nx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="nx-origin-center nx-transition-transform rtl:-nx-rotate-180 ltr:nx-rotate-90 rtl:nx-rotate-[-270deg]"></path></svg></a><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100 ltr:nx-pr-0 rtl:nx-pl-0 nx-pt-1"><ul class="nx-flex nx-flex-col nx-gap-1 nx-relative before:nx-absolute before:nx-inset-y-1 before:nx-w-px before:nx-bg-gray-200 before:nx-content-[&quot;&quot;] dark:before:nx-bg-neutral-800 ltr:nx-pl-3 ltr:before:nx-left-0 rtl:nx-pr-3 rtl:before:nx-right-0 ltr:nx-ml-3 rtl:nx-mr-3"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/architecture-experience/intro/">Intro</a></li><li class="nx-flex nx-flex-col nx-gap-1 active"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-bg-primary-100 nx-font-semibold nx-text-primary-800 dark:nx-bg-primary-400/10 dark:nx-text-primary-600 contrast-more:nx-border-primary-500 contrast-more:dark:nx-border-primary-500" href="/docs-resume/architecture-experience/message-queue-usage/">메시지 큐 기반 시스템 분해작업</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/architecture-experience/consumer-thread-optimization/">스레드 최적화</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/architecture-experience/test-case-experience/">테스트케이스 경험</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/architecture-experience/if-project-again/">프로젝트를 다시 한다면</a></li></ul></div></div></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/fyi/">FYI</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/docs-resume/change-history/">문서 변경 이력</a></li></ul></div></div></div><div class="nx-sticky nx-bottom-0 nx-bg-white dark:nx-bg-dark nx-mx-4 nx-py-4 nx-shadow-[0_-12px_16px_#fff] nx-flex nx-items-center nx-gap-2 dark:nx-border-neutral-800 dark:nx-shadow-[0_-12px_16px_#111] contrast-more:nx-border-neutral-400 contrast-more:nx-shadow-none contrast-more:dark:nx-shadow-none nx-border-t" data-toggle-animation="off"><div class="nx-grow nx-flex nx-flex-col"><button title="Change theme" class="nx-h-7 nx-rounded-md nx-px-2 nx-text-left nx-text-xs nx-font-medium nx-text-gray-600 nx-transition-colors dark:nx-text-gray-400 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50" id="headlessui-listbox-button-:Rlsr6:" type="button" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><div class="nx-flex nx-items-center nx-gap-2 nx-capitalize"><svg fill="none" viewBox="3 3 18 18" width="12" height="12" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" fill="currentColor" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg><span class="">Light</span></div></button></div></div></aside><nav class="nextra-toc nx-order-last nx-hidden nx-w-64 nx-shrink-0 xl:nx-block print:nx-hidden nx-px-4" aria-label="table of contents"><div class="nextra-scrollbar nx-sticky nx-top-16 nx-overflow-y-auto nx-pr-4 nx-pt-6 nx-text-sm [hyphens:auto] nx-max-h-[calc(100vh-var(--nextra-navbar-height)-env(safe-area-inset-bottom))] ltr:-nx-mr-4 rtl:-nx-ml-4"><p class="nx-mb-4 nx-font-semibold nx-tracking-tight">On This Page</p><ul><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#메시지-큐-기반-시스템-분해작업" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">메시지 큐 기반 시스템 분해작업</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#레거시-데이터-처리-서버---valuesight" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">레거시 데이터 처리 서버 - valuesight</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#overview" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Overview</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#서비스-역할-정의" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">서비스 역할 정의</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#waiker-data-live" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">waiker-data-live</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#waiker-data-collector" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">waiker-data-collector</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#waiker-data-websocket" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">waiker-data-websocket</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#아쉬웠던-점" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">아쉬웠던 점</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#생산자소비자-기반-동시성-처리-구조-커스터마이징" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">생산자/소비자 기반 동시성 처리 구조 커스터마이징</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#tsdb" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">TSDB</a></li></ul><div class="nx-mt-8 nx-border-t nx-bg-white nx-pt-8 nx-shadow-[0_-12px_16px_white] dark:nx-bg-dark dark:nx-shadow-[0_-12px_16px_#111] nx-sticky nx-bottom-0 nx-flex nx-flex-col nx-items-start nx-gap-2 nx-pb-8 dark:nx-border-neutral-800 contrast-more:nx-border-t contrast-more:nx-border-neutral-400 contrast-more:nx-shadow-none contrast-more:dark:nx-border-neutral-400"><a href="https://github.com/chagchagchag/docs-resume/issues/new?title=Feedback%20for%20%E2%80%9CMessage%20Queue%20Usage%E2%80%9D&amp;labels=feedback" target="_blank" rel="noreferrer" class="nx-text-xs nx-font-medium nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-100 contrast-more:nx-text-gray-800 contrast-more:dark:nx-text-gray-50">Question? Give us feedback →<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a><a class="nx-text-xs nx-font-medium nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-100 contrast-more:nx-text-gray-800 contrast-more:dark:nx-text-gray-50" href="https://github.com/chagchagchag/docs-resume/pages/architecture-experience/message-queue-usage.mdx">Edit this page</a></div></div></nav><div id="reach-skip-nav"></div><article class="nx-w-full nx-break-words nextra-content nx-flex nx-min-h-[calc(100vh-var(--nextra-navbar-height))] nx-min-w-0 nx-justify-center nx-pb-8 nx-pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="nx-w-full nx-min-w-0 nx-max-w-6xl nx-px-6 nx-pt-4 md:nx-px-12"><div class="nextra-breadcrumb nx-mt-1.5 nx-flex nx-items-center nx-gap-1 nx-overflow-hidden nx-text-sm nx-text-gray-500 dark:nx-text-gray-400 contrast-more:nx-text-current"><div class="nx-whitespace-nowrap nx-transition-colors nx-min-w-[24px] nx-overflow-hidden nx-text-ellipsis hover:nx-text-gray-900 dark:hover:nx-text-gray-100" title="시스템 설계 경험"><a href="/docs-resume/architecture-experience/">시스템 설계 경험</a></div><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-w-3.5 nx-shrink-0"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg><div class="nx-whitespace-nowrap nx-transition-colors nx-font-medium nx-text-gray-700 contrast-more:nx-font-bold contrast-more:nx-text-current dark:nx-text-gray-100 contrast-more:dark:nx-text-current" title="메시지 큐 기반 시스템 분해작업">메시지 큐 기반 시스템 분해작업</div></div><h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">메시지 큐 기반 시스템 분해작업<a href="#메시지-큐-기반-시스템-분해작업" id="메시지-큐-기반-시스템-분해작업" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">레거시 데이터 처리 서버 - valuesight<a href="#레거시-데이터-처리-서버---valuesight" id="레거시-데이터-처리-서버---valuesight" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">웨이커에서는 레거시 버전의 데이터 처리서버를 신규 버전으로 새로 개편을 해야 했습니다. valuesight 는 쉽게 설명하면 아래와 같은 역할을 합니다.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><img loading="lazy" width="729" height="249" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 320 120&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAYAAACuyE5IAAAASklEQVR4nD1KQQ6AMAxinfr/f+pFE+fM2iK7CAkQoLgHzQomkgmSCPkYD85jR2nNaUtojH+c97VuSFdWychQBVSrUoBi7y/O68YHWdkyQU1DzJwAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/docs-resume/_next/static/media/valuesight.48d787ad.png"/></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">레피니티브로부터 실시간으로 전달되는 주식 거래 raw 데이터를 수신</li>
<li class="nx-my-2">raw 데이터에 대한 현재가, 52주신고가, BID, ASK, 고가, 저가 등의 필드 매핑</li>
<li class="nx-my-2">웹소켓으로 현재가 Push</li>
<li class="nx-my-2">매핑된 데이터를 기반으로 일/시/분/초 별 저가/고가/시가/종가 데이터 집계</li>
<li class="nx-my-2">집계된 데이터를 PostgreSQL 에 저장</li>
</ul>
<br/>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">이 당시 valuesight 서버는 매일 새벽마다 서버가 다운되어서 개발자가 수동으로 재기동시키고, 비어있는 데이터를 크롤링을 통해서 매우고 있었습니다. valuesight WAS 코드에는 동기화/락 코드가 있었기 때문에 레피니티브에서의 시세 데이터 전송 속도를 개별 I/O 처리 작업이 따라가지 못하면서 어느 순간에는 더 이상 처리할 수 없는 상태에 자주 빠지게 되었습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">저의 경우에는 레거시 데이터 처리 서버인 valuesight 의 운영에 대한 어떤 이슈가 있는지에 대한 정보를 거의 전달받지 못하고 신규버전 출시 2주일 전에 코드만 전달 받은 채로 프로젝트를 넘겨받아서 시작했습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">레거시 서버의 신규 서버 전환 작업을 맡으면서 미리 개발자에게 언급 없이 레피니티브의 데이터 구독제를 바꿔서 상용에서 장애가 난 경험도 있었습니다. 이때 1주일간 로그를 추출한 후 필드매핑을 처음부터 일일이 한땀 한땀 떼어서 확인해서 다음날 미국장에 잘 되는지 확인해보던 잠 못자고 살 떨리던 경험도 있었고, M증권사의 개발팀 부장님과 컨택이 되서 구글 밋으로 회의를 하면서 실시간 데이터를 어떻게 처리하는 지에 대한 팁도 얻었던 경험이 있습니다.<br/></p>
<br/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Overview<a href="#overview" id="overview" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">미국 주식 시세 데이터를 처리하기 위해서 단계적으로 스레드 프로그래밍이 개선을 거듭했고, 최종적으로는 아래와 같은 구조가 되었습니다. 랩장님과 인프라팀의 인원들의 반대로 인해 도입하지 못한 기술적인 면들이 많았지만, 시간내에 프로젝트를 완료시킬 수 있는 최적의 구조는 아래와 같았습니다.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><img loading="lazy" width="1263" height="929" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 320 240&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAMAAADJ2y/JAAAAUVBMVEX////+/v79/v79/f38/Pz7/Pz++vn7+vr7+vn6+vr5+fn7+Pj4+fn4+fj3+fn4+Pr4+Pj3+Pn3+Pf39/f29/j39/X29vb19fb19fX09PTz8/NPX+6eAAAAOElEQVR42hXGWQLAEAwFwKfRTZXYw/0PivkaaF1PPq4PPnYnLzNAw8pv7p0gnNJKs2KIoACUJ6sJPlMCLGlc1kAAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/docs-resume/_next/static/media/overview.d5705b26.png"/></p>
<br/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">서비스 역할 정의<a href="#서비스-역할-정의" id="서비스-역할-정의" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">&quot;메시지 큐를 단순히 소비자와 생산자를 두는 것이 단순히 처리를 뒤로 미루는 용도로 사용하지 않아야 한다&quot;는 점에 집중해서 작업을 처리하는 구조와 메시지 소비 구조를 맞춰나가는 작업을 해왔습니다.<br/></p>
<br/>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">waiker-data-live<a href="#waiker-data-live" id="waiker-data-live" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><img loading="lazy" width="1224" height="283" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 320 80&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAIAAADq9gq6AAAALklEQVR42hXJuREAIAwDQfqv17IeE2Auu9kzc7eqckJyLw2hDuUWF5R8tikB/QCMSy5xB0q6RQAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/docs-resume/_next/static/media/waiker-data-live.287e4503.png"/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">레피니티브의 미국 주식 시세 데이터는 그 트래픽의 속도가 굉장히 빠릅니다. 이것을 온전히 데이터를 큐잉 하는 작업만으로도 부하가 상당했습니다. 이런 이유로 레피니티브의 raw 데이터를 우리팀의 구조에 맞춰서 변환하는 작업과 RabbitMQ에 지연 없이 전송이 가능하는 역할만을 전담하는 인스턴스인 <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">waiker-data-live</code> 를 별도로 두었습니다.</p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">레피니티브 raw 데이터 필드맵 변환</li>
<li class="nx-my-2">데이터타입 정형화</li>
<li class="nx-my-2">변환한 데이터를 RabbitMQ에 큐잉</li>
</ul>
<br/>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">waiker-data-live 는 서비스의 가장 앞단에서 원본 데이터를 서빙하는 역할을 합니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">레피니티브의 미국 주식 트래픽이 꽤 높기 때문에 앞단에서 원본 데이터만 서빙하는 역할의 서버를 따로 분리해야 했습니다.<br/></p>
<br/>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>데이터 타입 정형화</strong><br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">이 당시 레피니티브의 공식 문서를 찾거나 레피니티브 개발자 포럼에 질문을 남겨서 특정 필드가 나노세컨드 단위인지 밀리세컨드인지, 정수형 타입, 실수형 타입에는 어떤 것들이 있는지를 모두 확인해서 맞춰둔 후에 데이터타입을 포매팅하는 과정을 거쳤습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">혹시라도 이 글을 읽는 분들 중 레피니티브 데이터 개발 업무를 수행하는 데에 도움이 될 수도 있는 분들이 있을것 같아서 그 코드의 일부를 남겨보면 아래와 같습니다.<br/></p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-color-text)">@</span><span style="color:var(--shiki-token-keyword)">Slf4j</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">@</span><span style="color:var(--shiki-token-keyword)">Getter</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">FieldEntryUtils</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// ...</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span></span>
<span class="line"><span style="color:var(--shiki-color-text)">	</span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Function</span><span style="color:var(--shiki-color-text)">&lt;</span><span style="color:var(--shiki-token-keyword)">FieldEntry</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)">&gt; fieldEntryToStr_Function </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> (fieldEntry </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// 자체 정의한 switch ~ case 문에 존재하지 않는 타입도 String 으로 일단 받아서 확인하기 위해 추가</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">		</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">load</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">toString</span><span style="color:var(--shiki-color-text)">(); </span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">		</span><span style="color:var(--shiki-token-keyword)">switch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">loadType</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			</span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">UINT</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">UINT_1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">UINT_2</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">UINT_4</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">UINT_8</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				</span><span style="color:var(--shiki-token-keyword)">long</span><span style="color:var(--shiki-color-text)"> l </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">uintValue</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">String</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">valueOf</span><span style="color:var(--shiki-color-text)">(l);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			</span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">INT</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				</span><span style="color:var(--shiki-token-keyword)">long</span><span style="color:var(--shiki-color-text)"> l </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">intValue</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">String</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">valueOf</span><span style="color:var(--shiki-color-text)">(l);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			</span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">REAL</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">REAL_4RB</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">REAL_8RB</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				</span><span style="color:var(--shiki-token-keyword)">double</span><span style="color:var(--shiki-color-text)"> v </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">real</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">asDouble</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">String</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">valueOf</span><span style="color:var(--shiki-color-text)">(v);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			</span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">DOUBLE</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">DOUBLE_8</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">FLOAT</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">FLOAT_4</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				</span><span style="color:var(--shiki-token-keyword)">double</span><span style="color:var(--shiki-color-text)"> v </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">doubleValue</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">String</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">valueOf</span><span style="color:var(--shiki-color-text)">(v);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			</span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">DATE</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				</span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">date</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">day</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">0</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">					str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">LocalDate</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">of</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">date</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">year</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">date</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">month</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-color-text)">)</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">format</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">ServerStockTime</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">formatter</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				</span><span style="color:var(--shiki-token-keyword)">else</span><span style="color:var(--shiki-color-text)">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">					</span><span style="color:var(--shiki-token-keyword)">LocalDate</span><span style="color:var(--shiki-color-text)"> date </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">LocalDate</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">of</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">date</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">year</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">date</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">month</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">date</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">day</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">					str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">String</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">valueOf</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">date</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">format</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">ServerStockTime</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">formatter</span><span style="color:var(--shiki-color-text)">));</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			</span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">TIME</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				</span><span style="color:var(--shiki-token-keyword)">LocalTime</span><span style="color:var(--shiki-color-text)"> time </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">LocalTime</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">of</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">time</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">hour</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">time</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">minute</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">time</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">second</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">time</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">nanosecond</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">				</span><span style="color:var(--shiki-token-keyword)">long</span><span style="color:var(--shiki-color-text)"> l </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">time</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">toNanoOfDay</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">String</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">valueOf</span><span style="color:var(--shiki-color-text)">(l);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			</span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DataTypes</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">DATETIME</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-&gt;</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">				str </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">fieldEntry</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">dateTime</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">toString</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">			}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">		}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">		</span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> str;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">	});</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<br/>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>데이터 구조</strong><br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">일반적인 상용 서비스나 현실세계의 데이터가 아니어서 이해는 어렵겠지만, 당시에 사용했던 데이터의 구조는 아래와 같았습니다.</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">FieldEntryDto</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">implements</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">Serializable</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> ric;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">	</span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> nbRic;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">	</span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Map</span><span style="color:var(--shiki-color-text)">&lt;</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)">&gt; fieldMap;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">	</span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">SymbolDto</span><span style="color:var(--shiki-color-text)"> symbolDto;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// ...</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">그 당시 사용하던 Java 16 에서는 record 키워드가 preview 였고, 이 기능에 record 를 기반으로 전환할 지 고민을 거듭하다가 일반 class 기반으로 두었는데, 아마도 프로젝트를 다시 한다면 record 기반으로 구현하지 않았을까 싶습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">그 당시 메시지 큐를 카프카를 사용하는 것이 아니었기에 파티셔닝에 대해 고민하지 않았다는 점은 확실히 장점이었던 것 같습니다.</p>
<br/>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>아쉬웠던 점</strong><br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">waiker-data-live 의 경우 상태가 있는 서버 애플리케이션이 아니기에 EKS로 전환이 쉽고, 저 역시도 EKS 전환이 시급하다고 느껴왔던 프로젝트였지만, 이 당시 개발 기한문제도 있었고 EKS를 운영할 데브옵스 팀의 인력문제로 인해 k8s 네이티브 앱으로 전환하지 못한점이 가장 큰 아쉬움으로 남는 서비스입니다.<br/></p>
<br/>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">waiker-data-collector<a href="#waiker-data-collector" id="waiker-data-collector" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><img loading="lazy" width="947" height="450" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 320 160&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAMAAACEE47CAAAAM1BMVEX////+/v7+/f38/Pz7+/v6+/r6+vr5+vn4+Pj39/f09/f29vb19fXz9fXw8fPt7Ozq6urZ0/BPAAAAKElEQVR42g3BiQEAEAwDwJAqUd/+0+odaLXAJLw9b/QhOKnmsZCOgfwPCADJN50hiQAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/docs-resume/_next/static/media/waiker-data-collector.21f04080.png"/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">waiker-data-collector 는 <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">data-live-queue</code> 에서 데이터를 수신한 후 이 데이터를 일/시/분/초 단위로 시가/고가/종가/저가 를 집계하는 역할을 수행합니다. 그리고 집계된 데이터를 일정 주기별로 RabbitMQ 에 send 하거나 PostgreSQL 에 upsert 를 수행합니다.<br/></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">RabbitMQ <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">data-live-queue</code> 의 데이터 수신</li>
<li class="nx-my-2">데이터 필드 매핑 및 변환</li>
<li class="nx-my-2">데이터의 일/시/분/초 별 시가/고가/종가/저가 집계</li>
<li class="nx-my-2">현재가 기반 데이터를 별도의 웹소켓 데이터로 변환 작업 및 캐싱</li>
<li class="nx-my-2">집계된 데이터를 RabbitMQ <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">websocket-queue</code> Push</li>
<li class="nx-my-2">집계된 데이터를 PostgreSQL upsert</li>
</ul>
<br/>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">RabbitMQ <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">data-live-queue</code> 의 데이터를 수신하는 작업은 데이터의 트래픽이 높기에 별도의 스레딩 처리가 필요했습니다. 이것을 위해 리스너에서 데이터를 수신하는 역할을 하는 <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">listenerExecutor</code> 라는 별도의 ExecutorService 를 별도로 선언해두었고 RabbitMQ 로부터의 데이터의 수신작업은 모두 람다 바디 안에서 이뤄지게끔 했습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">데이터의 필드 매핑 및 변환 작업은 기술적으로 난이도가 높지는 않았지만, 주식 데이터의 필드 매핑을 파악하는 작업이 쉽지 않았습니다. 실제 raw 데이터의 필드 중 어떤 것이 실제 거래 가격인지 파악하는 것 부터 어떤 필드를 시간필드로 사용해야 하는지 등을 일일이 로그 파일을 json 덤프파일을 통해 정형화 후 테스트 코드 위에서 개발하는 작업을 거쳤습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">데이터의 일/시/분/초 별 시가/고가/종가/저가 집계 작업은 난이도가 쉬운편에 속했습니다. 특정 시간 영역 내에서 고가보다 높은 값이 들어오면 고가를 갱신하고 저가보다 낮은 가격이 들어오면 저가를 갱신하고, 특정 시간 영역 내의 종가를 계속 업데이트하는 등의 연산이었기에 구현의 난이도는 쉽지 않았습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">집계된 데이터를 RabbitMQ <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">websocket-queue</code> Push 작업을 하는 것은 쉽지 않았습니다. RabbitMQ로 데이터를 전송하는 네트워크 로직 자체가 네트워크 통신 로직이기에 블로킹 로직이고 이 블로킹 로직들을 적절한 사이즈의 스레드 풀 내에서 비동기 처리되게끔 해야 했습니다. 웹소켓 데이터의 경우 사용자에게 보여지는 항목이고 DB에 데이터 저장하는 것 보다는 어느 정도는 데이터를 유실되고 최신 데이터를 보내는 것에 중점을 둬야 한다는 것에 초점을 두었고, 오래된 데이터는 ttl 정책에 의해 캐시에서 제거되도록 하고, 일정시간 (0.01ms) 마다 데이터가 있는지를 검사해서 데이터가 있을 경우에만 List 단위로 데이터를 전송하도록 했습니다.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">현재가 기반 데이터를 별도의 웹소켓 데이터로 변환 작업 및 캐싱을 하는 작업은 난이도가 높지 않았습니다. 다만, 웹/앱에서 원하는 데이터의 형식을 조율하거나, nbRic, oric 의 요구사항 변경에 따른 로직 변경, 해당 주식 거래소의 현지시각으로 데이터의 거래시각 변경 후 전송 등 기획상에서 자주 바뀌는 부분들에 대해 대응하는 부분들이 많았습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">집계된 데이터를 PostgreSQL upsert 하는 작업은 비교적 비동기 작업의 처리가 수월했습니다. 현재가가 1분에도 수십번 이상 바뀌는 증권데이터 특성상 MVCC 작업으로 인해 PostgreSQL 내에서 Dead Tuple 이 기하급수적으로 늘어나는 현상이 있었습니다. 이 당시 MVCC 성능에 부하가 있더라도 장중 트래픽은 어느정도 느슨했기에 별 이슈는 없었지만, 장시작후 15분간, 장마감 전후 15분간은 MVCC 성능 저하로 인해 DB 데이터 저장에 레이턴시가 생겼고 처리 속도가 느려지는 이슈가 있었습니다. 애플리케이션의 스레드나 메모리를 Grafana 로 보더라도 웹 애플리케이션에는 이슈가 없었지만 DB의 MVCC 관련 이슈로 인해 PostgreSQL 에 Vaccum 작업을 필요한 시기에 제때 제때 해줬어야 했던 이슈가 있었습니다.<br/></p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">waiker-data-websocket<a href="#waiker-data-websocket" id="waiker-data-websocket" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><img loading="lazy" width="953" height="414" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 320 120&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAO0lEQVR42j3HSwrAIAwFwNz/rAqx5GNeUloRdHZDvbVHxOZkZgCZqapmRu6+HoCovlvEGug7xuhVdfsDLppGDGNeQc4AAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/docs-resume/_next/static/media/waiker-data-websocket.b22d3f96.png"/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">waiker-data-websocket 은 <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">websocket-queue</code> 의 데이터를 받아서 온전히 데이터를 웹/앱 으로 전송하는 역할만을 담당하도록 했습니다.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">초기 개발 시에는 waiker-data-collector 와 waiker-data-websocket 사이에 기능의 경계선이 모호했지만, 개발을 진행하면서 점점 waiker-data-websocket 은 데이터의 물리적인 전송에만 초점을 맞추도록 서비스를 구성했습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">이 당시 EKS 운영하고 관리할 데브옵스 인력이 없어서 EKS 기반의 k8s 앱으로 전환하지 못한 점은 아쉬웠다고 생각합니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">데이터를 전송하는 역할에만 초점이 맞춰져있지만, 레피니티브의 시세 데이터를 온전히 소모해야 하는 역할과 갈수록 많아지는 사용자들에게의 데이터 전송하는 역할로 인해 전체 서비스 중 waiker-data-websocket 서비스가 가장 부하가 심했다고 생각합니다.<br/></p>
<br/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">아쉬웠던 점<a href="#아쉬웠던-점" id="아쉬웠던-점" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">생산자/소비자 기반 동시성 처리 구조 커스터마이징<a href="#생산자소비자-기반-동시성-처리-구조-커스터마이징" id="생산자소비자-기반-동시성-처리-구조-커스터마이징" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">그 당시 인스턴스 각각은 Producer, Consumer, Queue 로 구성했습니다. 여기서 Queue 는 Hazelcast 를 활용했고 <a href="https://github.com/hazelcast/spring-data-hazelcast" target="_blank" rel="noreferrer" class="nx-text-primary-600 nx-underline nx-decoration-from-font [text-underline-position:from-font]">spring-data-hazelcast<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> 를 통해서 각 요청을 Set, Map&lt;String, List&lt;T&gt;&gt; 을 통해서 FIFO Queue 를 흉내낸 Write-Back 캐싱전략을 구현했습니다.</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><img loading="lazy" width="498" height="145" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 320 80&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAIAAADq9gq6AAAANUlEQVR42hXJsQkAMAgEwOw/piCvIKJYRLQJufYOM7v77fbMrJpZVQVwiMjMZjeq4seICIAHX9YsyIluLZwAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/docs-resume/_next/static/media/instance.d64b5431.png"/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">프로젝트를 다시 한다면, <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">데이터</code> 가 아닌 <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">요청</code> 을 기록하는 용도의 테이블을 따로 만들어서 기록을 하는 구조로 전환하게 될 것 같습니다. <br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">동시성 처리가 되어 있는 생산자/소비자 기능은 개별 요청을 기록(Insert) 하고, 주기적으로 이 테이블에서 벌크단위로 기록된 요청 데이터를 읽어들여서 시세테이블에 데이터를 적재하도록 구조를 전환해서 동일행 수정으로 인한 DBMS에서의 잦은 MVCC 이슈를 피하고, 각각의 요청을 고유하게 기록할 수 있는 구조로 전환하게끔 해보고 싶습니다.<br/><br/></p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">TSDB<a href="#tsdb" id="tsdb" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">1차적인 데이터 처리 용도의 데이터베이스는 관계형 데이터베이스 대신 시계열 데이터 기반의 데이터베이스를 적용했을 듯 합니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">관계형 데이터베이스를 억지로 시계열 데이터에 처음부터 맞추는 것은 억지스럽다는 생각은 했으나 당시 개발 여건 상 팀내의 입지나 여러모로 도입하기가 쉽지 않았습니다. 관계형 데이터베이스는 데이터를 중복을 없애고 일관성있는 논리적인 데이터의 구조를 통해 데이터를 효율적으로 저장하는 것이 목적이기에, 현재가/고가/저가/종가가 계속 변할 때마다 동시성 이슈가 크다고 생각했습니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">아마도 프로젝트를 다시 한다면 관계형 데이터베이스에는 최종적으로 데이터를 1분마다 집계한 최종 데이터를 저장하고, TSDB에 시세데이터를 증분기록하게끔 할 것 같습니다. 지금은 이렇게 적긴 했지만, 시세 데이터 자체가 관계형 데이테베이스에 저장한다는 것 자체가 저 자신은 가끔 이해가 안되긴 하지만, 팀내에서 이렇게 하기를 원한다면 관계형 DB에 저장을 하게 될 듯 합니다.<br/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">TSDB(InfluxDB 등) 외에도 MongoDB, ElasticSearch 가 대안이 될수 있을 것 같고, 완전하게 독자적으로 책임질수 있는 여건이라면 관계형 Database 에 시세를 기록하지는 않을 듯 합니다. 대신 시세 조회시에는 API를 통해서 조회를 하게끔 하고, 시세 서비스 내에서는 NoSQL 데이터베이스를 사용하게끔 했을 듯 합니다.<br/></p><div class="nx-mt-16"></div><div class="nx-mb-8 nx-flex nx-items-center nx-border-t nx-pt-8 dark:nx-border-neutral-800 contrast-more:nx-border-neutral-400 dark:contrast-more:nx-border-neutral-400 print:nx-hidden"><a title="Intro" class="nx-flex nx-max-w-[50%] nx-items-center nx-gap-1 nx-py-4 nx-text-base nx-font-medium nx-text-gray-600 nx-transition-colors [word-break:break-word] hover:nx-text-primary-600 dark:nx-text-gray-300 md:nx-text-lg ltr:nx-pr-4 rtl:nx-pl-4" href="/docs-resume/architecture-experience/intro/"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-inline nx-h-5 nx-shrink-0 ltr:nx-rotate-180"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Intro</a><a title="스레드 최적화" class="nx-flex nx-max-w-[50%] nx-items-center nx-gap-1 nx-py-4 nx-text-base nx-font-medium nx-text-gray-600 nx-transition-colors [word-break:break-word] hover:nx-text-primary-600 dark:nx-text-gray-300 md:nx-text-lg ltr:nx-ml-auto ltr:nx-pl-4 ltr:nx-text-right rtl:nx-mr-auto rtl:nx-pr-4 rtl:nx-text-left" href="/docs-resume/architecture-experience/consumer-thread-optimization/">스레드 최적화<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-inline nx-h-5 nx-shrink-0 rtl:nx-rotate-180"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></a></div></main></article></div><footer class="nx-bg-gray-100 nx-pb-[env(safe-area-inset-bottom)] dark:nx-bg-neutral-900 print:nx-bg-transparent"><div class="nx-mx-auto nx-flex nx-max-w-[90rem] nx-gap-2 nx-py-2 nx-px-4 nx-hidden"><button title="Change theme" class="nx-h-7 nx-rounded-md nx-px-2 nx-text-left nx-text-xs nx-font-medium nx-text-gray-600 nx-transition-colors dark:nx-text-gray-400 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50" id="headlessui-listbox-button-:Rkt6:" type="button" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><div class="nx-flex nx-items-center nx-gap-2 nx-capitalize"><svg fill="none" viewBox="3 3 18 18" width="12" height="12" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" fill="currentColor" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg><span class="">Light</span></div></button></div><hr class="dark:nx-border-neutral-800"/><div class="nx-mx-auto nx-flex nx-max-w-[90rem] nx-justify-center nx-py-12 nx-text-gray-600 dark:nx-text-gray-400 md:nx-justify-start nx-pl-[max(env(safe-area-inset-left),1.5rem)] nx-pr-[max(env(safe-area-inset-right),1.5rem)]">Nextra Docs Template</div></footer></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{}},"page":"/architecture-experience/message-queue-usage","query":{},"buildId":"GzRZMqokpyQjOyUBborm8","assetPrefix":"/docs-resume","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>